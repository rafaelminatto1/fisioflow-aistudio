# ========================================
# FISIOFLOW - PRODUÇÃO DIGITALOCEAN OTIMIZADA
# ========================================
# Configurações otimizadas para Professional XS

# ========================================
# AMBIENTE E APLICAÇÃO
# ========================================
NODE_ENV=production
NEXT_TELEMETRY_DISABLED=1
PORT=3000
HOSTNAME=0.0.0.0

# URL da aplicação (substitua pela sua URL do DigitalOcean)
NEXTAUTH_URL=https://fisioflow-app.ondigitalocean.app

# ========================================
# BANCO DE DADOS - OTIMIZADO PARA DIGITALOCEAN
# ========================================
# URLs com configurações otimizadas para App Platform
DATABASE_URL="postgresql://fisioflow_user:STRONG_PASSWORD@fisioflow-db-do-user-123456-0.b.db.ondigitalocean.com:25060/fisioflow?sslmode=require&pool_timeout=30&connect_timeout=30&pool_max=5&pool_min=1&statement_timeout=60000&query_timeout=60000"

DIRECT_URL="postgresql://fisioflow_user:STRONG_PASSWORD@fisioflow-db-do-user-123456-0.b.db.ondigitalocean.com:25060/fisioflow?sslmode=require&connect_timeout=30"

# ========================================
# CONFIGURAÇÕES DE POOL OTIMIZADAS
# ========================================
# Reduzidas para Professional XS (4GB RAM)
DB_POOL_SIZE=5
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=300000
DB_MAX_CONNECTIONS=5
DB_MIN_CONNECTIONS=1

# ========================================
# AUTENTICAÇÃO - NEXTAUTH
# ========================================
# Gere com: openssl rand -base64 32
NEXTAUTH_SECRET=SUBSTITUTE_BY_SECURE_32_CHAR_SECRET_HERE

# ========================================
# CACHE E PERFORMANCE OTIMIZADOS
# ========================================
ROUTE_CACHE_ENABLED=true
ROUTE_CACHE_TTL=600
IMAGE_CACHE_TTL=86400
COMPRESSION_ENABLED=true
STATIC_CACHE_TTL=3600

# ========================================
# LOGS OTIMIZADOS (PINO)
# ========================================
LOG_LEVEL=warn
LOG_PRETTY=false
LOG_FILE_ENABLED=false

# ========================================
# OTIMIZAÇÕES DE MEMÓRIA
# ========================================
# Reduzir uso de memória
NODE_OPTIONS="--max-old-space-size=2048 --max-semi-space-size=128"

# ========================================
# SEGURANÇA
# ========================================
STATUS_CHECK_TOKEN=SUBSTITUTE_BY_RANDOM_TOKEN_HERE
ENCRYPTION_KEY=SUBSTITUTE_BY_32_CHAR_ENCRYPTION_KEY

# CORS origins permitidas
CORS_ORIGINS=https://fisioflow-app.ondigitalocean.app

# ========================================
# DIGITALOCEAN ESPECÍFICO
# ========================================
DO_APP_NAME=fisioflow
DO_REGION=nyc1
DO_ENVIRONMENT=production

# Build otimizado
BUILD_COMMAND="npm ci --only=production && npx prisma generate && npm run build"
RUN_COMMAND="npm start"

# ========================================
# FEATURES DESABILITADAS PARA PERFORMANCE
# ========================================
# Reduzir overhead
DISABLE_ANALYTICS=true
DISABLE_TELEMETRY=true
SKIP_ENV_VALIDATION=true
NEXT_TELEMETRY_DISABLED=1

# ========================================
# CONFIGURAÇÕES CRÍTICAS
# ========================================
# IMPORTANTE: Configure no DigitalOcean App Platform
# 1. Environment Variables: Copie todas as variáveis acima
# 2. Plan: Professional XS (4GB RAM, 2 vCPUs)
# 3. Region: NYC1 (mesmo do banco)
# 4. Health Check: /api/health (90s timeout)
# 5. Build timeout: 15 minutos