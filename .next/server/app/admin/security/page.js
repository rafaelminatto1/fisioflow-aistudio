(()=>{var e={};e.id=636,e.ids=[636],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},10554:(e,s,a)=>{"use strict";a.r(s),a.d(s,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>d,routeModule:()=>x,tree:()=>c}),a(7422),a(32773),a(43188),a(35866);var r=a(23191),t=a(88716),i=a(37922),l=a.n(i),n=a(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(s,o);let c=["",{children:["admin",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,7422)),"C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\admin\\security\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,32773)),"C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,43188)),"C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\admin\\security\\page.tsx"],m="/admin/security/page",u={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:t.x.APP_PAGE,page:"/admin/security/page",pathname:"/admin/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},70753:(e,s,a)=>{Promise.resolve().then(a.bind(a,5850))},5850:(e,s,a)=>{"use strict";a.d(s,{RLSSecurityDashboard:()=>B});var r=a(10326),t=a(17577),i=a(33071),l=a(90772),n=a(567),o=a(43273),c=a(28407),d=a(77863);let m=c.fC,u=t.forwardRef(({className:e,...s},a)=>r.jsx(c.aV,{ref:a,className:(0,d.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));u.displayName=c.aV.displayName;let x=t.forwardRef(({className:e,...s},a)=>r.jsx(c.xz,{ref:a,className:(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));x.displayName=c.xz.displayName;let f=t.forwardRef(({className:e,...s},a)=>r.jsx(c.VY,{ref:a,className:(0,d.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));f.displayName=c.VY.displayName;let h=t.forwardRef(({className:e,...s},a)=>r.jsx("div",{className:"relative w-full overflow-auto",children:r.jsx("table",{ref:a,className:(0,d.cn)("w-full caption-bottom text-sm",e),...s})}));h.displayName="Table";let p=t.forwardRef(({className:e,...s},a)=>r.jsx("thead",{ref:a,className:(0,d.cn)("[&_tr]:border-b",e),...s}));p.displayName="TableHeader";let j=t.forwardRef(({className:e,...s},a)=>r.jsx("tbody",{ref:a,className:(0,d.cn)("[&_tr:last-child]:border-0",e),...s}));j.displayName="TableBody",t.forwardRef(({className:e,...s},a)=>r.jsx("tfoot",{ref:a,className:(0,d.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let g=t.forwardRef(({className:e,...s},a)=>r.jsx("tr",{ref:a,className:(0,d.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));g.displayName="TableRow";let b=t.forwardRef(({className:e,...s},a)=>r.jsx("th",{ref:a,className:(0,d.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));b.displayName="TableHead";let y=t.forwardRef(({className:e,...s},a)=>r.jsx("td",{ref:a,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));y.displayName="TableCell",t.forwardRef(({className:e,...s},a)=>r.jsx("caption",{ref:a,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";var N=a(54432),v=a(81128),w=a(941),R=a(96633),S=a(32933);let C=v.fC;v.ZA;let A=v.B4,L=t.forwardRef(({className:e,children:s,...a},t)=>(0,r.jsxs)(v.xz,{ref:t,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...a,children:[s,r.jsx(v.JO,{asChild:!0,children:r.jsx(w.Z,{className:"h-4 w-4 opacity-50"})})]}));L.displayName=v.xz.displayName;let E=t.forwardRef(({className:e,...s},a)=>r.jsx(v.u_,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:r.jsx(R.Z,{className:"h-4 w-4"})}));E.displayName=v.u_.displayName;let T=t.forwardRef(({className:e,...s},a)=>r.jsx(v.$G,{ref:a,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:r.jsx(w.Z,{className:"h-4 w-4"})}));T.displayName=v.$G.displayName;let Z=t.forwardRef(({className:e,children:s,position:a="popper",...t},i)=>r.jsx(v.h_,{children:(0,r.jsxs)(v.VY,{ref:i,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:a,...t,children:[r.jsx(E,{}),r.jsx(v.l_,{className:(0,d.cn)("p-1","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),r.jsx(T,{})]})}));Z.displayName=v.VY.displayName,t.forwardRef(({className:e,...s},a)=>r.jsx(v.__,{ref:a,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=v.__.displayName;let _=t.forwardRef(({className:e,children:s,...a},t)=>(0,r.jsxs)(v.ck,{ref:t,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...a,children:[r.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:r.jsx(v.wU,{children:r.jsx(S.Z,{className:"h-4 w-4"})})}),r.jsx(v.eT,{children:s})]}));_.displayName=v.ck.displayName,t.forwardRef(({className:e,...s},a)=>r.jsx(v.Z0,{ref:a,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=v.Z0.displayName;var P=a(21405),k=a(60763),O=a(15601),U=a(58038),z=a(66697),D=a(24061),q=a(88378),F=a(54689),I=a(94893),Y=a(98091),V=a(88319),M=a(41137),$=a(31540),G=a(12714),J=a(85999);function B(){let[e,s]=(0,t.useState)(null),[a,c]=(0,t.useState)([]),[d,v]=(0,t.useState)([]),[w,R]=(0,t.useState)([]),[S,E]=(0,t.useState)(!1),[T,B]=(0,t.useState)("overview"),[H,X]=(0,t.useState)({userId:"",tableName:"",operation:"",limit:100,offset:0}),W=async()=>{try{let e=await fetch("/api/neon/rls?action=status"),a=await e.json();a.success?s(a.data):J.Am.error("Failed to load RLS status")}catch(e){console.error("Error loading RLS status:",e),J.Am.error("Error loading RLS status")}},K=async()=>{try{let e=new URLSearchParams({action:"audit",...Object.fromEntries(Object.entries(H).map(([e,s])=>[e,s.toString()]))}),s=await fetch(`/api/neon/rls?${e}`),a=await s.json();a.success?c(a.data):J.Am.error("Failed to load audit logs")}catch(e){console.error("Error loading audit logs:",e),J.Am.error("Error loading audit logs")}},Q=async()=>{try{let e=await fetch("/api/neon/rls?action=policies"),s=await e.json();s.success?v(s.data):J.Am.error("Failed to load policies")}catch(e){console.error("Error loading policies:",e),J.Am.error("Error loading policies")}},ee=async()=>{try{let e=await fetch("/api/neon/rls?action=stats"),s=await e.json();s.success?R(s.data):J.Am.error("Failed to load access stats")}catch(e){console.error("Error loading access stats:",e),J.Am.error("Error loading access stats")}},es=async(e=!1)=>{E(!0);try{let s=await fetch("/api/neon/rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"setup",force:e})}),a=await s.json();a.success?(J.Am.success("RLS setup completed successfully"),await W(),await Q()):J.Am.error(a.error||"Failed to setup RLS")}catch(e){console.error("Error setting up RLS:",e),J.Am.error("Error setting up RLS")}finally{E(!1)}},ea=async()=>{if(confirm("Are you sure you want to reset RLS configuration? This will remove all policies.")){E(!0);try{let e=await fetch("/api/neon/rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reset"})}),s=await e.json();s.success?(J.Am.success("RLS configuration reset successfully"),await W(),await Q()):J.Am.error(s.error||"Failed to reset RLS")}catch(e){console.error("Error resetting RLS:",e),J.Am.error("Error resetting RLS")}finally{E(!1)}}},er=async()=>{E(!0);try{let e=await fetch("/api/neon/rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"test"})}),s=await e.json();s.success?J.Am.success("RLS tests completed successfully"):J.Am.error(s.error||"RLS tests failed")}catch(e){console.error("Error testing RLS:",e),J.Am.error("Error testing RLS")}finally{E(!1)}},et=async(e=30)=>{if(confirm(`Are you sure you want to delete audit logs older than ${e} days?`)){E(!0);try{let s=await fetch(`/api/neon/rls?days=${e}`,{method:"DELETE"}),a=await s.json();a.success?(J.Am.success("Audit logs cleaned up successfully"),await K()):J.Am.error(a.error||"Failed to cleanup audit logs")}catch(e){console.error("Error cleaning up audit logs:",e),J.Am.error("Error cleaning up audit logs")}finally{E(!1)}}},ei=async()=>{E(!0);try{await Promise.all([W(),K(),Q(),ee()]),J.Am.success("Data refreshed successfully")}catch(e){J.Am.error("Error refreshing data")}finally{E(!1)}},el=e=>{switch(e){case"INSERT":return"bg-green-100 text-green-800";case"UPDATE":return"bg-blue-100 text-blue-800";case"DELETE":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"RLS Security Dashboard"}),r.jsx("p",{className:"text-muted-foreground",children:"Monitor and manage Row Level Security configuration"})]}),r.jsx("div",{className:"flex items-center gap-2",children:(0,r.jsxs)(l.z,{variant:"outline",size:"sm",onClick:ei,disabled:S,children:[r.jsx(P.Z,{className:`h-4 w-4 mr-2 ${S?"animate-spin":""}`}),"Refresh"]})})]}),(0,r.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"RLS Status"}),e?.isConfigured?r.jsx(k.Z,{className:"h-4 w-4 text-green-600"}):r.jsx(O.Z,{className:"h-4 w-4 text-red-600"})]}),(0,r.jsxs)(i.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:r.jsx("span",{className:e?.isConfigured?"text-green-600":"text-red-600",children:e?.isConfigured?"Configured":"Not Configured"})}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e?.tablesWithRLS.length||0," tables protected"]})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Security Policies"}),r.jsx(U.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:e?.policiesCount||0}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Active security policies"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Audit Logs"}),r.jsx(z.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:a.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Recent activity records"})]})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[r.jsx(i.ll,{className:"text-sm font-medium",children:"Access Stats"}),r.jsx(D.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,r.jsxs)(i.aY,{children:[r.jsx("div",{className:"text-2xl font-bold",children:w.length}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique access patterns"})]})]})]}),!e?.isConfigured&&(0,r.jsxs)(o.bZ,{children:[r.jsx(O.Z,{className:"h-4 w-4"}),r.jsx(o.X,{children:'Row Level Security is not configured. Click "Setup RLS" to configure security policies.'})]}),(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Configuration Management"}),r.jsx(i.SZ,{children:"Manage RLS configuration and security policies"})]}),r.jsx(i.aY,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)(l.z,{onClick:()=>es(!1),disabled:S,variant:e?.isConfigured?"outline":"default",children:[r.jsx(q.Z,{className:"h-4 w-4 mr-2"}),"Setup RLS"]}),(0,r.jsxs)(l.z,{onClick:()=>es(!0),disabled:S,variant:"outline",children:[r.jsx(F.Z,{className:"h-4 w-4 mr-2"}),"Force Reconfigure"]}),(0,r.jsxs)(l.z,{onClick:er,disabled:S,variant:"outline",children:[r.jsx(I.Z,{className:"h-4 w-4 mr-2"}),"Test RLS"]}),(0,r.jsxs)(l.z,{onClick:ea,disabled:S,variant:"destructive",children:[r.jsx(Y.Z,{className:"h-4 w-4 mr-2"}),"Reset RLS"]})]})})]}),(0,r.jsxs)(m,{value:T,onValueChange:B,children:[(0,r.jsxs)(u,{children:[r.jsx(x,{value:"overview",children:"Overview"}),r.jsx(x,{value:"policies",children:"Security Policies"}),r.jsx(x,{value:"audit",children:"Audit Logs"}),r.jsx(x,{value:"stats",children:"Access Statistics"})]}),r.jsx(f,{value:"overview",className:"space-y-4",children:(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Protected Tables"}),r.jsx(i.SZ,{children:"Tables with Row Level Security enabled"})]}),r.jsx(i.aY,{children:r.jsx("div",{className:"grid gap-2",children:e?.tablesWithRLS.map(e=>r.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[r.jsx("span",{className:"font-medium",children:e}),r.jsxs(n.C,{variant:"secondary",children:[r.jsx(V.Z,{className:"h-3 w-3 mr-1"}),"Protected"]})]},e))})})]})}),r.jsx(f,{value:"policies",className:"space-y-4",children:(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Security Policies"}),r.jsx(i.SZ,{children:"Active RLS policies and their configurations"})]}),r.jsx(i.aY,{children:(0,r.jsxs)(h,{children:[r.jsx(p,{children:(0,r.jsxs)(g,{children:[r.jsx(b,{children:"Table"}),r.jsx(b,{children:"Policy Name"}),r.jsx(b,{children:"Command"}),r.jsx(b,{children:"Roles"}),r.jsx(b,{children:"Type"})]})}),r.jsx(j,{children:d.map((e,s)=>(0,r.jsxs)(g,{children:[r.jsx(y,{className:"font-medium",children:e.tablename}),r.jsx(y,{children:e.policyname}),r.jsx(y,{children:r.jsx(n.C,{variant:"outline",children:e.cmd})}),r.jsx(y,{children:e.roles?.join(", ")||"All"}),r.jsx(y,{children:r.jsx(n.C,{variant:"PERMISSIVE"===e.permissive?"default":"secondary",children:e.permissive})})]},e.schemaname+e.tablename+e.policyname))})]})})]})}),r.jsx(f,{value:"audit",className:"space-y-4",children:(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Audit Logs"}),r.jsx(i.SZ,{children:"Database activity monitoring and security audit trail"})]}),(0,r.jsxs)(i.aY,{children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[r.jsx(N.I,{placeholder:"Filter by User ID",value:H.userId,onChange:e=>X(s=>({...s,userId:e.target.value})),className:"max-w-xs"}),(0,r.jsxs)(C,{value:H.tableName,onValueChange:e=>X(s=>({...s,tableName:e})),children:[r.jsx(L,{className:"max-w-xs",children:r.jsx(A,{placeholder:"Filter by Table"})}),(0,r.jsxs)(Z,{children:[r.jsx(_,{value:"",children:"All Tables"}),r.jsx(_,{value:"User",children:"User"}),r.jsx(_,{value:"Patient",children:"Patient"}),r.jsx(_,{value:"Appointment",children:"Appointment"}),r.jsx(_,{value:"PainPoint",children:"PainPoint"}),r.jsx(_,{value:"MetricResult",children:"MetricResult"}),r.jsx(_,{value:"SoapNote",children:"SoapNote"})]})]}),(0,r.jsxs)(C,{value:H.operation,onValueChange:e=>X(s=>({...s,operation:e})),children:[r.jsx(L,{className:"max-w-xs",children:r.jsx(A,{placeholder:"Filter by Operation"})}),(0,r.jsxs)(Z,{children:[r.jsx(_,{value:"",children:"All Operations"}),r.jsx(_,{value:"INSERT",children:"INSERT"}),r.jsx(_,{value:"UPDATE",children:"UPDATE"}),r.jsx(_,{value:"DELETE",children:"DELETE"})]})]}),(0,r.jsxs)(l.z,{variant:"outline",size:"sm",onClick:K,children:[r.jsx(M.Z,{className:"h-4 w-4 mr-2"}),"Apply Filters"]}),(0,r.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([["ID,Table,Operation,User ID,User Role,Timestamp",...a.map(e=>[e.id,e.table_name,e.operation,e.user_id,e.user_role,e.timestamp].join(","))].join("\n")],{type:"text/csv"}),s=URL.createObjectURL(e),r=document.createElement("a");r.href=s,r.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,r.click(),URL.revokeObjectURL(s)},children:[r.jsx($.Z,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,r.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>et(30),children:[r.jsx(Y.Z,{className:"h-4 w-4 mr-2"}),"Cleanup"]})]}),(0,r.jsxs)(h,{children:[r.jsx(p,{children:(0,r.jsxs)(g,{children:[r.jsx(b,{children:"Timestamp"}),r.jsx(b,{children:"Table"}),r.jsx(b,{children:"Operation"}),r.jsx(b,{children:"User"}),r.jsx(b,{children:"Role"}),r.jsx(b,{children:"Actions"})]})}),r.jsx(j,{children:a.map(e=>(0,r.jsxs)(g,{children:[r.jsx(y,{className:"text-sm",children:new Date(e.timestamp).toLocaleString()}),r.jsx(y,{className:"font-medium",children:e.table_name}),r.jsx(y,{children:r.jsx(n.C,{className:el(e.operation),children:e.operation})}),r.jsx(y,{className:"text-sm",children:e.user_id}),r.jsx(y,{children:r.jsx(n.C,{variant:"outline",children:e.user_role})}),r.jsx(y,{children:r.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{J.Am.info("Check console for detailed log information")},children:r.jsx(G.Z,{className:"h-4 w-4"})})})]},e.id))})]})]})]})}),r.jsx(f,{value:"stats",className:"space-y-4",children:(0,r.jsxs)(i.Zb,{children:[(0,r.jsxs)(i.Ol,{children:[r.jsx(i.ll,{children:"Access Statistics"}),r.jsx(i.SZ,{children:"User access patterns and database usage statistics (last 7 days)"})]}),r.jsx(i.aY,{children:(0,r.jsxs)(h,{children:[r.jsx(p,{children:(0,r.jsxs)(g,{children:[r.jsx(b,{children:"User Role"}),r.jsx(b,{children:"Table"}),r.jsx(b,{children:"Operation"}),r.jsx(b,{children:"Count"}),r.jsx(b,{children:"Last Access"})]})}),r.jsx(j,{children:w.map((e,s)=>(0,r.jsxs)(g,{children:[r.jsx(y,{children:r.jsx(n.C,{variant:"outline",children:e.user_role})}),r.jsx(y,{className:"font-medium",children:e.table_name}),r.jsx(y,{children:r.jsx(n.C,{className:el(e.operation),children:e.operation})}),r.jsx(y,{className:"text-right",children:e.operation_count}),r.jsx(y,{className:"text-sm",children:new Date(e.last_access).toLocaleString()})]},e.user_role+e.table_name+e.operation+e.last_access))})]})})]})})]})]})}},43273:(e,s,a)=>{"use strict";a.d(s,{X:()=>c,bZ:()=>o});var r=a(10326),t=a(17577),i=a(79360),l=a(77863);let n=(0,i.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),o=t.forwardRef(({className:e,variant:s,...a},t)=>r.jsx("div",{ref:t,role:"alert",className:(0,l.cn)(n({variant:s}),e),...a}));o.displayName="Alert",t.forwardRef(({className:e,...s},a)=>r.jsx("h5",{ref:a,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";let c=t.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",e),...s}));c.displayName="AlertDescription"},33071:(e,s,a)=>{"use strict";a.d(s,{Ol:()=>n,SZ:()=>c,Zb:()=>l,aY:()=>d,ll:()=>o});var r=a(10326),t=a(17577),i=a(77863);let l=t.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));l.displayName="Card";let n=t.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...s}));n.displayName="CardHeader";let o=t.forwardRef(({className:e,...s},a)=>r.jsx("h3",{ref:a,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s}));o.displayName="CardTitle";let c=t.forwardRef(({className:e,...s},a)=>r.jsx("p",{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",e),...s}));c.displayName="CardDescription";let d=t.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("p-6 pt-0",e),...s}));d.displayName="CardContent",t.forwardRef(({className:e,...s},a)=>r.jsx("div",{ref:a,className:(0,i.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter"},54432:(e,s,a)=>{"use strict";a.d(s,{I:()=>l});var r=a(10326),t=a(17577),i=a(77863);let l=t.forwardRef(({className:e,type:s,...a},t)=>r.jsx("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...a}));l.displayName="Input"},7422:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>o,metadata:()=>n});var r=a(19510),t=a(58585),i=a(90455);let l=(0,a(68570).createProxy)(String.raw`C:\Users\amand\Rafael\aifisio\fisioflow-aistudio\components\rls-security-dashboard.tsx#RLSSecurityDashboard`),n={title:"Security Dashboard | FisioFlow",description:"Row Level Security monitoring and management dashboard"};async function o(){let e=await (0,i.I8)();return e||(0,t.redirect)("/auth/signin"),"Admin"!==e.user.role&&(0,t.redirect)("/dashboard"),r.jsx("div",{className:"container mx-auto py-6",children:r.jsx(l,{})})}}};var s=require("../../../webpack-runtime.js");s.C(e);var a=e=>s(s.s=e),r=s.X(0,[216,237,119],()=>a(10554));module.exports=r})();