(()=>{var e={};e.id=636,e.ids=[636],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},61212:e=>{"use strict";e.exports=require("async_hooks")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},10554:(e,s,r)=>{"use strict";r.r(s),r.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c}),r(7422),r(32773),r(43188),r(35866);var t=r(23191),a=r(88716),i=r(37922),l=r.n(i),n=r(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);r.d(s,o);let c=["",{children:["admin",{children:["security",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,7422)),"C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\admin\\security\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,32773)),"C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\admin\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,43188)),"C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,35866,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\amand\\Rafael\\aifisio\\fisioflow-aistudio\\app\\admin\\security\\page.tsx"],u="/admin/security/page",x={require:r,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/security/page",pathname:"/admin/security",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},70753:(e,s,r)=>{Promise.resolve().then(r.bind(r,5850))},5850:(e,s,r)=>{"use strict";r.d(s,{RLSSecurityDashboard:()=>B});var t=r(10326),a=r(17577),i=r(33071),l=r(90772),n=r(567),o=r(43273),c=r(28407),d=r(77863);let u=c.fC,x=a.forwardRef(({className:e,...s},r)=>t.jsx(c.aV,{ref:r,className:(0,d.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));x.displayName=c.aV.displayName;let m=a.forwardRef(({className:e,...s},r)=>t.jsx(c.xz,{ref:r,className:(0,d.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));m.displayName=c.xz.displayName;let h=a.forwardRef(({className:e,...s},r)=>t.jsx(c.VY,{ref:r,className:(0,d.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));h.displayName=c.VY.displayName;let f=a.forwardRef(({className:e,...s},r)=>t.jsx("div",{className:"relative w-full overflow-auto",children:t.jsx("table",{ref:r,className:(0,d.cn)("w-full caption-bottom text-sm",e),...s})}));f.displayName="Table";let p=a.forwardRef(({className:e,...s},r)=>t.jsx("thead",{ref:r,className:(0,d.cn)("[&_tr]:border-b",e),...s}));p.displayName="TableHeader";let j=a.forwardRef(({className:e,...s},r)=>t.jsx("tbody",{ref:r,className:(0,d.cn)("[&_tr:last-child]:border-0",e),...s}));j.displayName="TableBody",a.forwardRef(({className:e,...s},r)=>t.jsx("tfoot",{ref:r,className:(0,d.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let g=a.forwardRef(({className:e,...s},r)=>t.jsx("tr",{ref:r,className:(0,d.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));g.displayName="TableRow";let y=a.forwardRef(({className:e,...s},r)=>t.jsx("th",{ref:r,className:(0,d.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));y.displayName="TableHead";let b=a.forwardRef(({className:e,...s},r)=>t.jsx("td",{ref:r,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));b.displayName="TableCell",a.forwardRef(({className:e,...s},r)=>t.jsx("caption",{ref:r,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";var N=r(54432),w=r(81128),v=r(941),R=r(96633),S=r(32933);let A=w.fC;w.ZA;let C=w.B4,L=a.forwardRef(({className:e,children:s,...r},a)=>(0,t.jsxs)(w.xz,{ref:a,className:(0,d.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[s,t.jsx(w.JO,{asChild:!0,children:t.jsx(v.Z,{className:"h-4 w-4 opacity-50"})})]}));L.displayName=w.xz.displayName;let E=a.forwardRef(({className:e,...s},r)=>t.jsx(w.u_,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(R.Z,{className:"h-4 w-4"})}));E.displayName=w.u_.displayName;let T=a.forwardRef(({className:e,...s},r)=>t.jsx(w.$G,{ref:r,className:(0,d.cn)("flex cursor-default items-center justify-center py-1",e),...s,children:t.jsx(v.Z,{className:"h-4 w-4"})}));T.displayName=w.$G.displayName;let Z=a.forwardRef(({className:e,children:s,position:r="popper",...a},i)=>t.jsx(w.h_,{children:(0,t.jsxs)(w.VY,{ref:i,className:(0,d.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...a,children:[t.jsx(E,{}),t.jsx(w.l_,{className:(0,d.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),t.jsx(T,{})]})}));Z.displayName=w.VY.displayName,a.forwardRef(({className:e,...s},r)=>t.jsx(w.__,{ref:r,className:(0,d.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=w.__.displayName;let P=a.forwardRef(({className:e,children:s,...r},a)=>(0,t.jsxs)(w.ck,{ref:a,className:(0,d.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[t.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:t.jsx(w.wU,{children:t.jsx(S.Z,{className:"h-4 w-4"})})}),t.jsx(w.eT,{children:s})]}));P.displayName=w.ck.displayName,a.forwardRef(({className:e,...s},r)=>t.jsx(w.Z0,{ref:r,className:(0,d.cn)("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=w.Z0.displayName;var _=r(21405),k=r(60763),O=r(15601),q=r(58038),U=r(66697),z=r(24061),D=r(88378),I=r(54689),F=r(94893),Y=r(98091),V=r(88319),M=r(41137),$=r(31540),G=r(12714),J=r(85999);function B(){let[e,s]=(0,a.useState)(null),[r,c]=(0,a.useState)([]),[d,w]=(0,a.useState)([]),[v,R]=(0,a.useState)([]),[S,E]=(0,a.useState)(!1),[T,B]=(0,a.useState)("overview"),[H,W]=(0,a.useState)({userId:"",tableName:"",operation:"",limit:100,offset:0}),X=async()=>{try{let e=await fetch("/api/neon/rls?action=status"),r=await e.json();r.success?s(r.data):J.Am.error("Failed to load RLS status")}catch(e){console.error("Error loading RLS status:",e),J.Am.error("Error loading RLS status")}},K=async()=>{try{let e=new URLSearchParams({action:"audit",...Object.fromEntries(Object.entries(H).map(([e,s])=>[e,s.toString()]))}),s=await fetch(`/api/neon/rls?${e}`),r=await s.json();r.success?c(r.data):J.Am.error("Failed to load audit logs")}catch(e){console.error("Error loading audit logs:",e),J.Am.error("Error loading audit logs")}},Q=async()=>{try{let e=await fetch("/api/neon/rls?action=policies"),s=await e.json();s.success?w(s.data):J.Am.error("Failed to load policies")}catch(e){console.error("Error loading policies:",e),J.Am.error("Error loading policies")}},ee=async()=>{try{let e=await fetch("/api/neon/rls?action=stats"),s=await e.json();s.success?R(s.data):J.Am.error("Failed to load access stats")}catch(e){console.error("Error loading access stats:",e),J.Am.error("Error loading access stats")}},es=async(e=!1)=>{E(!0);try{let s=await fetch("/api/neon/rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"setup",force:e})}),r=await s.json();r.success?(J.Am.success("RLS setup completed successfully"),await X(),await Q()):J.Am.error(r.error||"Failed to setup RLS")}catch(e){console.error("Error setting up RLS:",e),J.Am.error("Error setting up RLS")}finally{E(!1)}},er=async()=>{if(confirm("Are you sure you want to reset RLS configuration? This will remove all policies.")){E(!0);try{let e=await fetch("/api/neon/rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"reset"})}),s=await e.json();s.success?(J.Am.success("RLS configuration reset successfully"),await X(),await Q()):J.Am.error(s.error||"Failed to reset RLS")}catch(e){console.error("Error resetting RLS:",e),J.Am.error("Error resetting RLS")}finally{E(!1)}}},et=async()=>{E(!0);try{let e=await fetch("/api/neon/rls",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"test"})}),s=await e.json();s.success?J.Am.success("RLS tests completed successfully"):J.Am.error(s.error||"RLS tests failed")}catch(e){console.error("Error testing RLS:",e),J.Am.error("Error testing RLS")}finally{E(!1)}},ea=async(e=30)=>{if(confirm(`Are you sure you want to delete audit logs older than ${e} days?`)){E(!0);try{let s=await fetch(`/api/neon/rls?days=${e}`,{method:"DELETE"}),r=await s.json();r.success?(J.Am.success("Audit logs cleaned up successfully"),await K()):J.Am.error(r.error||"Failed to cleanup audit logs")}catch(e){console.error("Error cleaning up audit logs:",e),J.Am.error("Error cleaning up audit logs")}finally{E(!1)}}},ei=async()=>{E(!0);try{await Promise.all([X(),K(),Q(),ee()]),J.Am.success("Data refreshed successfully")}catch(e){J.Am.error("Error refreshing data")}finally{E(!1)}},el=e=>{switch(e){case"INSERT":return"bg-green-100 text-green-800";case"UPDATE":return"bg-blue-100 text-blue-800";case"DELETE":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"RLS Security Dashboard"}),t.jsx("p",{className:"text-muted-foreground",children:"Monitor and manage Row Level Security configuration"})]}),t.jsx("div",{className:"flex items-center gap-2",children:(0,t.jsxs)(l.z,{variant:"outline",size:"sm",onClick:ei,disabled:S,children:[t.jsx(_.Z,{className:`h-4 w-4 mr-2 ${S?"animate-spin":""}`}),"Refresh"]})})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(i.ll,{className:"text-sm font-medium",children:"RLS Status"}),e?.isConfigured?t.jsx(k.Z,{className:"h-4 w-4 text-green-600"}):t.jsx(O.Z,{className:"h-4 w-4 text-red-600"})]}),(0,t.jsxs)(i.aY,{children:[t.jsx("div",{className:"text-2xl font-bold",children:t.jsx("span",{className:e?.isConfigured?"text-green-600":"text-red-600",children:e?.isConfigured?"Configured":"Not Configured"})}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e?.tablesWithRLS.length||0," tables protected"]})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(i.ll,{className:"text-sm font-medium",children:"Security Policies"}),t.jsx(q.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(i.aY,{children:[t.jsx("div",{className:"text-2xl font-bold",children:e?.policiesCount||0}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Active security policies"})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(i.ll,{className:"text-sm font-medium",children:"Audit Logs"}),t.jsx(U.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(i.aY,{children:[t.jsx("div",{className:"text-2xl font-bold",children:r.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Recent activity records"})]})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[t.jsx(i.ll,{className:"text-sm font-medium",children:"Access Stats"}),t.jsx(z.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,t.jsxs)(i.aY,{children:[t.jsx("div",{className:"text-2xl font-bold",children:v.length}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique access patterns"})]})]})]}),!e?.isConfigured&&(0,t.jsxs)(o.bZ,{children:[t.jsx(O.Z,{className:"h-4 w-4"}),t.jsx(o.X,{children:'Row Level Security is not configured. Click "Setup RLS" to configure security policies.'})]}),(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[t.jsx(i.ll,{children:"Configuration Management"}),t.jsx(i.SZ,{children:"Manage RLS configuration and security policies"})]}),t.jsx(i.aY,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)(l.z,{onClick:()=>es(!1),disabled:S,variant:e?.isConfigured?"outline":"default",children:[t.jsx(D.Z,{className:"h-4 w-4 mr-2"}),"Setup RLS"]}),(0,t.jsxs)(l.z,{onClick:()=>es(!0),disabled:S,variant:"outline",children:[t.jsx(I.Z,{className:"h-4 w-4 mr-2"}),"Force Reconfigure"]}),(0,t.jsxs)(l.z,{onClick:et,disabled:S,variant:"outline",children:[t.jsx(F.Z,{className:"h-4 w-4 mr-2"}),"Test RLS"]}),(0,t.jsxs)(l.z,{onClick:er,disabled:S,variant:"destructive",children:[t.jsx(Y.Z,{className:"h-4 w-4 mr-2"}),"Reset RLS"]})]})})]}),(0,t.jsxs)(u,{value:T,onValueChange:B,children:[(0,t.jsxs)(x,{children:[t.jsx(m,{value:"overview",children:"Overview"}),t.jsx(m,{value:"policies",children:"Security Policies"}),t.jsx(m,{value:"audit",children:"Audit Logs"}),t.jsx(m,{value:"stats",children:"Access Statistics"})]}),t.jsx(h,{value:"overview",className:"space-y-4",children:(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[t.jsx(i.ll,{children:"Protected Tables"}),t.jsx(i.SZ,{children:"Tables with Row Level Security enabled"})]}),t.jsx(i.aY,{children:t.jsx("div",{className:"grid gap-2",children:e?.tablesWithRLS.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-2 border rounded",children:[t.jsx("span",{className:"font-medium",children:e}),t.jsxs(n.C,{variant:"secondary",children:[t.jsx(V.Z,{className:"h-3 w-3 mr-1"}),"Protected"]})]},e))})})]})}),t.jsx(h,{value:"policies",className:"space-y-4",children:(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[t.jsx(i.ll,{children:"Security Policies"}),t.jsx(i.SZ,{children:"Active RLS policies and their configurations"})]}),t.jsx(i.aY,{children:(0,t.jsxs)(f,{children:[t.jsx(p,{children:(0,t.jsxs)(g,{children:[t.jsx(y,{children:"Table"}),t.jsx(y,{children:"Policy Name"}),t.jsx(y,{children:"Command"}),t.jsx(y,{children:"Roles"}),t.jsx(y,{children:"Type"})]})}),t.jsx(j,{children:d.map((e,s)=>(0,t.jsxs)(g,{children:[t.jsx(b,{className:"font-medium",children:e.tablename}),t.jsx(b,{children:e.policyname}),t.jsx(b,{children:t.jsx(n.C,{variant:"outline",children:e.cmd})}),t.jsx(b,{children:e.roles?.join(", ")||"All"}),t.jsx(b,{children:t.jsx(n.C,{variant:"PERMISSIVE"===e.permissive?"default":"secondary",children:e.permissive})})]},s))})]})})]})}),t.jsx(h,{value:"audit",className:"space-y-4",children:(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[t.jsx(i.ll,{children:"Audit Logs"}),t.jsx(i.SZ,{children:"Database activity monitoring and security audit trail"})]}),(0,t.jsxs)(i.aY,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(N.I,{placeholder:"Filter by User ID",value:H.userId,onChange:e=>W(s=>({...s,userId:e.target.value})),className:"max-w-xs"}),(0,t.jsxs)(A,{value:H.tableName,onValueChange:e=>W(s=>({...s,tableName:e})),children:[t.jsx(L,{className:"max-w-xs",children:t.jsx(C,{placeholder:"Filter by Table"})}),(0,t.jsxs)(Z,{children:[t.jsx(P,{value:"",children:"All Tables"}),t.jsx(P,{value:"User",children:"User"}),t.jsx(P,{value:"Patient",children:"Patient"}),t.jsx(P,{value:"Appointment",children:"Appointment"}),t.jsx(P,{value:"PainPoint",children:"PainPoint"}),t.jsx(P,{value:"MetricResult",children:"MetricResult"}),t.jsx(P,{value:"SoapNote",children:"SoapNote"})]})]}),(0,t.jsxs)(A,{value:H.operation,onValueChange:e=>W(s=>({...s,operation:e})),children:[t.jsx(L,{className:"max-w-xs",children:t.jsx(C,{placeholder:"Filter by Operation"})}),(0,t.jsxs)(Z,{children:[t.jsx(P,{value:"",children:"All Operations"}),t.jsx(P,{value:"INSERT",children:"INSERT"}),t.jsx(P,{value:"UPDATE",children:"UPDATE"}),t.jsx(P,{value:"DELETE",children:"DELETE"})]})]}),(0,t.jsxs)(l.z,{variant:"outline",size:"sm",onClick:K,children:[t.jsx(M.Z,{className:"h-4 w-4 mr-2"}),"Apply Filters"]}),(0,t.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>{let e=new Blob([["ID,Table,Operation,User ID,User Role,Timestamp",...r.map(e=>[e.id,e.table_name,e.operation,e.user_id,e.user_role,e.timestamp].join(","))].join("\n")],{type:"text/csv"}),s=URL.createObjectURL(e),t=document.createElement("a");t.href=s,t.download=`audit-logs-${new Date().toISOString().split("T")[0]}.csv`,t.click(),URL.revokeObjectURL(s)},children:[t.jsx($.Z,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,t.jsxs)(l.z,{variant:"outline",size:"sm",onClick:()=>ea(30),children:[t.jsx(Y.Z,{className:"h-4 w-4 mr-2"}),"Cleanup"]})]}),(0,t.jsxs)(f,{children:[t.jsx(p,{children:(0,t.jsxs)(g,{children:[t.jsx(y,{children:"Timestamp"}),t.jsx(y,{children:"Table"}),t.jsx(y,{children:"Operation"}),t.jsx(y,{children:"User"}),t.jsx(y,{children:"Role"}),t.jsx(y,{children:"Actions"})]})}),t.jsx(j,{children:r.map(e=>(0,t.jsxs)(g,{children:[t.jsx(b,{className:"text-sm",children:new Date(e.timestamp).toLocaleString()}),t.jsx(b,{className:"font-medium",children:e.table_name}),t.jsx(b,{children:t.jsx(n.C,{className:el(e.operation),children:e.operation})}),t.jsx(b,{className:"text-sm",children:e.user_id}),t.jsx(b,{children:t.jsx(n.C,{variant:"outline",children:e.user_role})}),t.jsx(b,{children:t.jsx(l.z,{variant:"ghost",size:"sm",onClick:()=>{J.Am.info("Check console for detailed log information")},children:t.jsx(G.Z,{className:"h-4 w-4"})})})]},e.id))})]})]})]})}),t.jsx(h,{value:"stats",className:"space-y-4",children:(0,t.jsxs)(i.Zb,{children:[(0,t.jsxs)(i.Ol,{children:[t.jsx(i.ll,{children:"Access Statistics"}),t.jsx(i.SZ,{children:"User access patterns and database usage statistics (last 7 days)"})]}),t.jsx(i.aY,{children:(0,t.jsxs)(f,{children:[t.jsx(p,{children:(0,t.jsxs)(g,{children:[t.jsx(y,{children:"User Role"}),t.jsx(y,{children:"Table"}),t.jsx(y,{children:"Operation"}),t.jsx(y,{children:"Count"}),t.jsx(y,{children:"Last Access"})]})}),t.jsx(j,{children:v.map((e,s)=>(0,t.jsxs)(g,{children:[t.jsx(b,{children:t.jsx(n.C,{variant:"outline",children:e.user_role})}),t.jsx(b,{className:"font-medium",children:e.table_name}),t.jsx(b,{children:t.jsx(n.C,{className:el(e.operation),children:e.operation})}),t.jsx(b,{className:"text-right",children:e.operation_count}),t.jsx(b,{className:"text-sm",children:new Date(e.last_access).toLocaleString()})]},s))})]})})]})})]})]})}},54432:(e,s,r)=>{"use strict";r.d(s,{I:()=>l});var t=r(10326),a=r(17577),i=r(77863);let l=a.forwardRef(({className:e,type:s,...r},a)=>t.jsx("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...r}));l.displayName="Input"},7422:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>o,metadata:()=>n});var t=r(19510),a=r(58585),i=r(90455);let l=(0,r(68570).createProxy)(String.raw`C:\Users\amand\Rafael\aifisio\fisioflow-aistudio\components\rls-security-dashboard.tsx#RLSSecurityDashboard`),n={title:"Security Dashboard | FisioFlow",description:"Row Level Security monitoring and management dashboard"};async function o(){let e=await (0,i.I8)();return e||(0,a.redirect)("/auth/signin"),"Admin"!==e.user.role&&(0,a.redirect)("/dashboard"),t.jsx("div",{className:"container mx-auto py-6",children:t.jsx(l,{})})}}};var s=require("../../../webpack-runtime.js");s.C(e);var r=e=>s(s.s=e),t=s.X(0,[216,237,305],()=>r(10554));module.exports=t})();